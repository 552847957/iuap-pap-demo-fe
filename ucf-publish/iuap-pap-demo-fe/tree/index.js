<<<<<<< HEAD
/*! build:ucf hash:e68ba93b8d9f266f6dde, chunkhash:25b3d2aa37c7ac0ac447, name:tree/index, filebase:index.js, query:, file:tree/index.js */!function(e){function t(t){for(var n,i,c=t[0],s=t[1],l=t[2],d=0,p=[];d<c.length;d++)i=c[d],r[i]&&p.push(r[i][0]),r[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(u&&u(t);p.length;)p.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,c=1;c<a.length;c++){var s=a[c];0!==r[s]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},r={7:0},o=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=s;o.push([1579,0]),a()}({1567:function(e,t,a){},1568:function(e,t,a){},1569:function(e,t,a){},1570:function(e,t,a){},1579:function(e,t,a){"use strict";a.r(t);a(161);var n=a(0),r=a.n(n),o=a(2),i=a.n(o),c=a(6),s=a.n(c),l=a(8),u=a.n(l),d=a(17),p=a.n(d),m=a(10),h=a.n(m),f=a(11),g=a.n(f),b=a(12),v=a.n(b),w=a(13),E=a.n(w),T=a(32),x=a.n(T),y=a(14),S=a.n(y),P=a(3),D=a(50),k=a(54),O=a(25),A=a(66),_=a(5),j=(a(1567),O.a.Item),M=P.Select.Option,N=["新增","修改","详情"],L=function(e){function t(e){var a;return h()(this,t),(a=v()(this,E()(t).call(this,e))).onCloseEdit=function(){var e,t=a.props.comModalParam;e=Object.assign({},t,{showModal:!1,btnFlag:0}),o.actions.walsinTree.updateState({comModalParam:e,showLoading:!1})},a.onSubmitEdit=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t=x()(a)).props.form.validateFields(function(){var e=p()(u.a.mark(function e(a,n){var r,i,c,s,l,d,p,m,h;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,o.actions.walsinTree.updateState({showLoading:!0});case 6:if(r=t.props||{},i=r.comModalParam,c=r.paginationParam,l=(s=i||{}).initEditValue,d=s.btnFlag,p=c.reqParam||{},m=p.search_treeId,h={},console.log("onsave oldData",l),d||m){e.next=13;break}return t.onCloseEdit(),o.actions.walsinTree.updateState({showLoading:!1}),Object(_.a)("请选择树节点"),e.abrupt("return");case 13:if(t.handleIntData(n),h=Object.assign({},{treeId:m},l,n),!d){e.next=20;break}return e.next=18,o.actions.walsinTree.addEditData(h);case 18:e.next=22;break;case 20:return e.next=22,o.actions.walsinTree.addTableData(h);case 22:t.onCloseEdit();case 23:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e)})),a.handleIntData=function(e){for(var t=0,a=["age"];t<a.length;t++){var n=a[t];void 0!==e[n]&&(e[n]=Number(e[n]))}},a.onHideEdit=function(){a.onCloseEdit()},a.onHandleBtns=function(e){return 2==e?[]:a.defaultBtnConfig},a.defaultBtnConfig=[{label:"取消",fun:a.onCloseEdit,shape:"border"},{label:"确定",fun:a.onSubmitEdit,colors:"primary"}],a.state={},a}return S()(t,e),g()(t,[{key:"render",value:function(){var e=this.props,t=e.form,a=e.comModalParam||{},n=a.showModal,o=void 0!==n&&n,i=a.initEditValue,c=void 0===i?{}:i,l=a.btnFlag,u=void 0===l?0:l,d=t.getFieldProps,p=t.getFieldError,m=c||{},h=m.name,f=m.sex,g=m.age,b=this.onHandleBtns(u);return r.a.createElement(A.a,{show:o,title:N[u],size:"lg",btns:b,close:this.onCloseEdit},r.a.createElement(O.a,null,r.a.createElement(j,{required:!0,label:"员工姓名"},r.a.createElement(P.FormControl,s()({disabled:2==u},d("name",{validateTrigger:"onBlur",initialValue:h||"",rules:[{type:"string",required:!0,pattern:/\S+/gi,message:"请输入员工姓名"}]}))),r.a.createElement("span",{className:"error"},p("name"))),r.a.createElement(j,{required:!0,label:"员工性别"},r.a.createElement(P.Select,s()({disabled:2==u},d("sex",{initialValue:f||1,rules:[{required:!0,message:"请选择员工性别"}]})),r.a.createElement(M,{value:1},"女"),r.a.createElement(M,{value:2},"男")),r.a.createElement("span",{className:"error"},p("sex"))),r.a.createElement(j,{required:!0,label:"年龄"},r.a.createElement(P.InputNumber,s()({iconStyle:"one",min:1,step:1,max:99,disabled:2==u},d("age",{initialValue:g||"",rules:[{type:"number",max:99,transform:function(e){return 1*e},pattern:/^[0-9]+$/,required:!0,message:"年龄需小于100"}]}))),r.a.createElement("span",{className:"error"},p("age")))))}}]),t}(n.Component),C=O.a.createForm()(L),I=a(18),V=a(55),H=a(76),q=(a(1568),function(e){function t(e){var a;return h()(this,t),(a=v()(this,E()(t).call(this,e))).getSelectedDataFunc=function(e){console.log("selvalue",e),o.actions.walsinTree.updateState({tableSelValue:e})},a.freshData=function(e){a.onPageSelect(e,0)},a.onDataNumSelect=function(e,t){a.onPageSelect(t,1)},a.onPageSelect=function(e,t){var n=x()(a),r=n.props.paginationParam,i=r.reqParam&&Object(_.f)(r.reqParam)||{};console.log("paginationParam",r);var c=Object(_.k)(e,t,i),s=c.pageIndex,l=c.pageSize;i.pageIndex=s,i.pageSize=l,o.actions.walsinTree.loadTable(i),n.resetSelData()},a.onCommonClick=function(e){return function(t){var n=x()(a).props,r=n.comModalParam,i=n.paginationParam,c=n.tableSelValue,s={},l=c.length;if(r=Object(_.f)(r),e>0){if(!Array.isArray(c)||!l)return void Object(_.c)("请选择表数据");if(l>1)return void Object(_.c)("请选择单条表数据");s=Object.assign({},r,{showModal:!0,initEditValue:c[0],btnFlag:e})}else{void 0!==i.reqParam&&i.reqParam.search_treeId||""?s={showModal:!0,btnFlag:e,initEditValue:{}}:Object(_.c)("请选择表数据所属树节点")}o.actions.walsinTree.updateState({comModalParam:s})}},a.onDelete=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.tableSelValue,!(Array.isArray(t)&&t.length>0)){e.next=6;break}return e.next=4,o.actions.walsinTree.updateState({delModal:!0});case 4:e.next=7;break;case 6:Object(_.c)("请选择数据");case 7:case"end":return e.stop()}},e)})),a.onModalDel=function(){var e=p()(u.a.mark(function e(t){var n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=x()(a),r=n.props.tableSelValue,!t){e.next=10;break}return e.next=5,o.actions.walsinTree.updateState({showLoading:!0});case 5:return e.next=7,o.actions.walsinTree.delTableData(r);case 7:n.closeModal(),e.next=11;break;case 10:n.closeModal();case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.closeModal=p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.actions.walsinTree.updateState({showLoading:!1,delModal:!1});case 2:case"end":return e.stop()}},e)})),a.onExport=function(){a.grid.exportExcel()},a.resetSelData=function(){o.actions.walsinTree.updateState({tableSelValue:[]})},a.onHandleDisabled=function(){var e=a.props.tableSelValue.length;return e?1==e?{0:!1,1:!1,2:!1,3:!1}:{0:!1,1:!0,2:!0,3:!1}:{0:!1,1:!0,2:!0,3:!0}},a.getHeight=function(){var e,t=Math.max(document.body.clientHeight,document.documentElement.clientHeight),n=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);e=(t<n&&t||n)-42-58-43-42-32,a.setState({tableHeight:e})},a.state={tableHeight:500},a.grid=null,a.column=[{title:"姓名",dataIndex:"name",key:"name",width:200},{title:"性别",dataIndex:"sexEnumValue",key:"sexEnumValue",width:200},{title:"年龄",dataIndex:"age",key:"age",width:200}],a}return S()(t,e),g()(t,[{key:"componentWillMount",value:function(){var e=this;e.getHeight(),window.onresize=function(){e.getHeight()}}},{key:"componentWillUnmount",value:function(){window.onresize={}}},{key:"componentDidMount",value:function(){var e=this.props.paginationParam;o.actions.walsinTree.loadTable(e.reqParam||{pageIndex:0,pageSize:25}),this.resetSelData()}},{key:"render",value:function(){var e=this,t=this.props,a=t.tableData,n=void 0===a?[]:a,o=t.paginationParam,i=t.delModal,c=(o.reqParam||{}).pageIndex,s=o.resParam||{},l=s.totalPages,u=void 0===l?0:l,d=s.total,p={activePage:c+1,total:void 0===d?0:d,items:u,freshData:this.freshData,onDataNumSelect:this.onDataNumSelect},m=this.onHandleDisabled(),h=this.state.tableHeight;return r.a.createElement("div",{className:"tree-table"},r.a.createElement("div",{className:"table-header"},r.a.createElement(H.a,{funcCode:"tree"},r.a.createElement(I.a,{colors:"primary",style:{margin:8},onClick:this.onCommonClick(0),role:"add",disabled:m[0]},"新增"),r.a.createElement(I.a,{style:{margin:8},onClick:this.onCommonClick(1),role:"update",shape:"border",disabled:m[1]},"修改"),r.a.createElement(I.a,{style:{margin:8},shape:"border",onClick:this.onCommonClick(2),disabled:m[2]},"详情"),r.a.createElement(I.a,{style:{margin:8},onClick:this.onDelete,role:"delete",shape:"border",disabled:m[3]},"删除")),r.a.createElement(I.a,{style:{margin:8},size:"sm",onClick:this.onExport,shape:"border"},"导出")),r.a.createElement(k.a,{ref:function(t){return e.grid=t},data:n,rowKey:function(e,t){return e.id},columns:this.column,paginationObj:p,getSelectedDataFunc:this.getSelectedDataFunc,multiSelect:{type:"checkbox"},scroll:{y:h}}),r.a.createElement(C,this.props),r.a.createElement(V.a,{show:i,context:"是否要删除 ?",confirmFn:function(){return e.onModalDel(!0)},cancelFn:function(){return e.onModalDel(!1)}}))}}]),t}(n.Component)),F=(a(1569),P.Tree.TreeNode),B=function(e){function t(e){var a;return h()(this,t),(a=v()(this,E()(t).call(this,e))).onExpand=function(e){o.actions.walsinTree.updateState({searchRes:{expandedKeys:e,autoExpandParent:!1}})},a.onChange=function(e){x()(a).setState({searchValue:e})},a.onSearch=p()(u.a.mark(function e(){var t,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=x()(a),n=t.state.searchValue,e.next=3,o.actions.walsinTree.getSearchTree({searchValue:n});case 3:case"end":return e.stop()}},e)})),a.onSelect=function(e,t){var n=x()(a),r=t.selectedNodes,i=e.length?e[0]:"",c="",s="";if(r.length){var l=r[0],u=l.props;c=l.props.title.props.children[2],s=u.hierarchy}var d,p=n.props.paginationParam;d=Object.assign({},p.reqParam||{},{search_treeId:i,title:c,hierarchy:s}),o.actions.walsinTree.loadTable(d)},a.onMouseEnter=function(e){var t=Object(_.f)(a.state.editNode);t.isHover=e.node.props.eventKey,a.setState({editNode:t})},a.onMouseLeave=function(e,t){a.setState({editNode:{isHover:"",editKey:""}})},a.onDrop=function(){var e=p()(u.a.mark(function e(t){var n,r,i,c,s;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=x()(a),r=t.dragNode,i=t.node,c=Object(_.m)(n.props.content,{id:r.props.eventKey},0),s=Object.assign({},c,{parentId:i.props.eventKey}),e.next=6,o.actions.walsinTree.dragNode({curNode:c,reqParam:s});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onLoadData=function(e){console.log("treeNode",e);var t=e.props.eventKey,n=x()(a);return new Promise(function(e,a){n.idLoaded(t)||o.actions.walsinTree.loadTree({id:t}),e()}).then(function(e){console.log("result",e)}).catch(function(e){console.log("失败："+e)})},a.idLoaded=function(e){var t=x()(a),n=t.props.content;return n.length>0&&t.checkedLoaded(n,e)},a.checkedLoaded=function(e,t){for(var n=e.length,r=!1,o=0;o<n;o++){var i=e[o],c=i.children;if(i.id==t){if(c&&c.length>0){r=!0;break}}else c&&(r=a.checkedLoaded(c,t))}return r},a.getHeight=function(){var e=Math.min(window.innerHeight,document.body.clientHeight,document.documentElement.clientHeight),t=Math.min(window.innerHeight,document.body.scrollHeight,document.documentElement.scrollHeight);document.documentElement.offsetHeight;return(e<t&&e||t)-32-document.documentElement.scrollTop},a.getTableWidth=function(){return Math.min(window.innerWidth,document.documentElement.clientWidth,document.body.clientWidth)-250},a.state={searchValue:"",editNode:{isHover:"",editKey:""}},a}return S()(t,e),g()(t,[{key:"componentDidMount",value:function(){o.actions.walsinTree.loadTree()}},{key:"render",value:function(){var e=this.props,t=e.showLoading,a=e.content,n=e.searchRes,o=e.paginationParam,i=n.expandedKeys,c=n.autoExpandParent,l=o.reqParam,u=(void 0===l?{}:l).search_treeId,d=this.state.searchValue,p=this.getTableWidth();return r.a.createElement("div",{className:"tree-example"},r.a.createElement(D.a,{title:"B1左树右表示例"}),r.a.createElement("div",{className:"tree-body"},r.a.createElement("div",{className:"tree-wrap"},r.a.createElement("div",{className:"tree"},r.a.createElement("div",{className:"tree-head"},"组织机构"),r.a.createElement("div",{className:"tree-search"},r.a.createElement(P.FormControl,{className:"search-box",placeholder:"Search",onChange:this.onChange,onSearch:this.onSearch,value:d,type:"search"})),a.length?r.a.createElement(P.Tree,{showLine:!0,openIcon:r.a.createElement(P.Icon,{type:"uf-arrow-down"}),closeIcon:r.a.createElement(P.Icon,{type:"uf-arrow-right"}),onExpand:this.onExpand,expandedKeys:i,autoExpandParent:c,defaultExpandAll:!0,onSelect:this.onSelect,onCheck:this.onSelect,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,draggable:!1,onDragEnter:this.onDragEnter,onDrop:this.onDrop,loadData:this.onLoadData,selectedKeys:[u]},function e(t){return t.map(function(t){var a=t.name.search(d),n=t.name.substr(0,a),o=t.name.substr(a+d.length),i=a>-1?r.a.createElement("span",null,n,r.a.createElement("span",{style:{color:"#f50"}},d),o):r.a.createElement("span",null,t.name);return t.children&&t.children.length?r.a.createElement(F,{className:"tree-node",hierarchy:t.parentId,title:i,key:t.id},e(t.children)):r.a.createElement(F,{className:"tree-node",hierarchy:t.parentId,title:i,key:t.id,isLeaf:void 0===t.isSon||1===t.isSon})})}(a)):r.a.createElement("div",{className:"no-search-container"},r.a.createElement("span",{className:"no-search"},"未查询到相关数据"))),r.a.createElement("div",{className:"table-wrap"},r.a.createElement(q,s()({},this.props,{tableWidth:p})))),r.a.createElement(P.Loading,{show:t,fullScreen:!0})))}}]),t}(n.Component),K=a(157),R=a.n(K),z=a(29),W=a.n(z),G=a(21),J={GET_DETAIL:"".concat("/iuap-pap-demo-be","/allowances/list"),GET_TREE_DATA:"".concat("/iuap-pap-demo-be","/tree_demo/getSonNodes"),DRAG_NODE:"".concat("/iuap-pap-demo-be","/tree_demo/draftingNode"),GET_TABLE_DATA:"".concat("/iuap-pap-demo-be","/table_demo/list"),ADD_TABLE_DATA:"".concat("/iuap-pap-demo-be","/table_demo/insertSelective"),EDIT_SAVE_DATA:"".concat("/iuap-pap-demo-be","/table_demo/updateSelective"),DEL_TABLE_DATA:"".concat("/iuap-pap-demo-be","/table_demo/deleteBatch"),TREE_SEARCH:"".concat("/iuap-pap-demo-be","/tree_demo/dataSearchNodes")},U=function(e){return console.log("param",e),Object(G.a)(J.GET_TREE_DATA,{method:"get",param:e})},$=function(e){return Object(G.a)(J.GET_TABLE_DATA,{method:"get",param:e})},Q=function(e){return console.log("param",e),Object(G.a)(J.DRAG_NODE,{method:"post",data:e})},X=function(e){return Object(G.a)(J.ADD_TABLE_DATA,{method:"post",data:e})},Y=function(e){return Object(G.a)(J.EDIT_SAVE_DATA,{method:"post",data:e})},Z=function(e){return Object(G.a)(J.DEL_TABLE_DATA,{method:"post",data:e})},ee=function(e){return Object(G.a)(J.TREE_SEARCH,{method:"get",param:e})},te=(a(4),{name:"walsinTree",initialState:{content:[],cacheTree:[],paginationParam:{reqParam:{search_treeId:"",title:"",hierarchy:"",pageIndex:0,pageSize:25},resParam:{totalPages:0,total:0}},tableData:[],tableSelValue:[],showLoading:!1,comModalParam:{showModal:!1,initEditValue:{},btnFlag:0},delModal:!1,searchRes:{expandedKeys:[],autoExpandParent:!1}},reducers:{updateState:function(e,t){return W()({},e,t)}},effects:{loadTree:function(){var e=p()(u.a.mark(function e(t,a){var n,r,i,c,s,l,d;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("loadTree param",t),n=a().walsinTree.cacheTree,e.t0=_.o,e.next=5,U(t);case 5:e.t1=e.sent,r=(0,e.t0)(e.t1),i=r.result,c=i.data,s=[],l=c&&c.content||[],n=c&&c.content&&n.concat(c.content),d=Object(_.f)(a().walsinTree.content),s=0===d.length?Object(_.f)(l):Object(_.d)(d,l),o.actions.walsinTree.updateState({content:s,cacheTree:n});case 15:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),dragNode:function(){var e=p()(u.a.mark(function e(t,a){var n,r,i,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(_.f)(a().walsinTree.content),r={},!t.reqParam){e.next=10;break}return e.t0=_.o,e.next=6,Q(t.reqParam);case 6:e.t1=e.sent,i=(0,e.t0)(e.t1),c=i.result,r=c.data;case 10:r&&(Object(_.m)(n,t.curNode,1),console.log("cacheContent",n),Object(_.d)(n,Array.isArray(r)?r:[r]),o.actions.walsinTree.updateState({content:n}));case 11:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),loadTable:function(){var e=p()(u.a.mark(function e(t,a){var n,r,i,c,s;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.actions.walsinTree.updateState({showLoading:!0});case 2:return e.prev=2,e.t0=_.o,e.next=6,$(t);case 6:return e.t1=e.sent,n=(0,e.t0)(e.t1),r=n.result,i=r.data,c=[],s={},i&&(c=i.content,s=Object.assign({},{reqParam:t,resParam:{total:i.totalElements,totalPages:i.totalPages}})),e.next=14,o.actions.walsinTree.updateState({tableData:c,paginationParam:s,tableSelValue:[],showLoading:!1});case 14:e.next=19;break;case 16:e.prev=16,e.t2=e.catch(2),o.actions.walsinTree.updateState({showLoading:!1});case 19:case"end":return e.stop()}},e,null,[[2,16]])}));return function(t,a){return e.apply(this,arguments)}}(),addTableData:function(){var e=p()(u.a.mark(function e(t,a){var n,r,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=_.o,e.next=3,X(t);case 3:e.t1=e.sent,n=(0,e.t0)(e.t1,"添加成功"),r=n.result,r.data&&(i=a().walsinTree.paginationParam.reqParam,o.actions.walsinTree.loadTable(i));case 8:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),addEditData:function(){var e=p()(u.a.mark(function e(t,a){var n,r,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=_.o,e.next=3,Y(t);case 3:e.t1=e.sent,n=(0,e.t0)(e.t1,"修改成功"),r=n.result,r.data&&(i=a().walsinTree.paginationParam.reqParam,o.actions.walsinTree.loadTable(i));case 8:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),delTableData:function(){var e=p()(u.a.mark(function e(t,a){var n,r,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=_.o,e.next=3,Z(t);case 3:e.t1=e.sent,n=(0,e.t0)(e.t1,"删除成功"),r=n.result,r.data&&((i=a().walsinTree.paginationParam.reqParam).pageIndex=0,o.actions.walsinTree.loadTable(i));case 8:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),getSearchTree:function(){var e=p()(u.a.mark(function e(t,a){var n,r,i,c,s,l,d,p,m,h,f,g,b,v,w;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.actions.walsinTree.updateState({showLoading:!0});case 2:return n=t.searchValue,r=a().walsinTree.paginationParam,r=Object(_.f)(r),c=(i=r).reqParam,s=i.reqParam,l=s.title,d=s.hierarchy,console.log("searchValue",R()(t.searchValue)),e.prev=7,e.t0=_.o,e.next=11,ee(t);case 11:if(e.t1=e.sent,p=(0,e.t0)(e.t1),m=p.result,h=m.data,g=(f=void 0!==h&&h||{content:[],parentIdSet:[]}).content,b=f.parentIdSet,console.log("res",h),!Array.isArray(g)){e.next=27;break}return v={},w={content:g,searchRes:{expandedKeys:b,autoExpandParent:!!t.searchValue}},(""==n&&"0"!=d||!l.includes(n))&&(v={search_treeId:"",title:"",hierarchy:""}),r.reqParam=Object.assign({},c,v),w.paginationParam=r,e.next=25,o.actions.walsinTree.updateState(w);case 25:e.next=28;break;case 27:throw new Error("返回content为null");case 28:e.next=34;break;case 30:e.prev=30,e.t2=e.catch(7),console.log(e.t2),o.actions.walsinTree.updateState({showLoading:!1,content:[]});case 34:return e.next=36,o.actions.walsinTree.updateState({showLoading:!1});case 36:case"end":return e.stop()}},e,null,[[7,30]])}));return function(t,a){return e.apply(this,arguments)}}()}});i.a.model(te);var ae=Object(o.connect)(function(e){return e.walsinTree},null)(B);a(1570);Object(o.render)(r.a.createElement(ae,null),document.querySelector("#app"))}});
=======
/*! build:ucf hash:2aff9828fc249ad54ad6, chunkhash:8948f16bcc3426cada33, name:tree/index, filebase:index.js, query:, file:tree/index.js */!function(k){function e(e){for(var t,a,n=e[0],r=e[1],o=e[2],c=0,i=[];c<n.length;c++)a=n[c],F[a]&&i.push(F[a][0]),F[a]=0;for(t in r)Object.prototype.hasOwnProperty.call(r,t)&&(k[t]=r[t]);for(y&&y(e);i.length;)i.shift()();return v.push.apply(v,o||[]),l()}function l(){for(var e,t=0;t<v.length;t++){for(var a=v[t],n=!0,r=1;r<a.length;r++){var o=a[r];0!==F[o]&&(n=!1)}n&&(v.splice(t--,1),e=R(R.s=a[0]))}return e}var a=window.webpackHotUpdate;window.webpackHotUpdate=function(e,t){!function(e,t){if(!C[e]||!p[e])return;for(var a in p[e]=!1,t)Object.prototype.hasOwnProperty.call(t,a)&&(N[a]=t[a]);0==--s&&0===d&&m()}(e,t),a&&a(e,t)};var o,n=!0,j="2aff9828fc249ad54ad6",t=1e4,A={},M=[],r=[];var c=[],H="idle";function I(e){H=e;for(var t=0;t<c.length;t++)c[t].call(null,e)}var i,N,L,s=0,d=0,u={},p={},C={};function q(e){return+e+""===e?+e:e}function f(e){if("idle"!==H)throw new Error("check() is only allowed in idle status");return n=e,I("check"),(o=t,o=o||1e4,new Promise(function(t,a){if("undefined"==typeof XMLHttpRequest)return a(new Error("No browser support"));try{var n=new XMLHttpRequest,r=R.p+""+j+".hot-update.json";n.open("GET",r,!0),n.timeout=o,n.send(null)}catch(e){return a(e)}n.onreadystatechange=function(){if(4===n.readyState)if(0===n.status)a(new Error("Manifest request to "+r+" timed out."));else if(404===n.status)t();else if(200!==n.status&&304!==n.status)a(new Error("Manifest request to "+r+" failed."));else{try{var e=JSON.parse(n.responseText)}catch(e){return void a(e)}t(e)}}})).then(function(e){if(!e)return I("idle"),null;p={},u={},C=e.c,L=e.h,I("prepare");var t=new Promise(function(e,t){i={resolve:e,reject:t}});for(var a in N={},F)h(a);return"prepare"===H&&0===d&&0===s&&m(),t});var o}function h(e){var t,a;C[e]?(p[e]=!0,s++,t=e,(a=document.createElement("script")).charset="utf-8",a.src=R.p+""+t+"."+j+".hot-update.js",document.head.appendChild(a)):u[e]=!0}function m(){I("ready");var t=i;if(i=null,t)if(n)Promise.resolve().then(function(){return g(n)}).then(function(e){t.resolve(e)},function(e){t.reject(e)});else{var e=[];for(var a in N)Object.prototype.hasOwnProperty.call(N,a)&&e.push(q(a));t.resolve(e)}}function g(a){if("ready"!==H)throw new Error("apply() is only allowed in ready status");var e,t,n,d,r;function o(e){for(var t=[e],a={},n=t.slice().map(function(e){return{chain:[e],id:e}});0<n.length;){var r=n.pop(),o=r.id,c=r.chain;if((d=V[o])&&!d.hot._selfAccepted){if(d.hot._selfDeclined)return{type:"self-declined",chain:c,moduleId:o};if(d.hot._main)return{type:"unaccepted",chain:c,moduleId:o};for(var i=0;i<d.parents.length;i++){var l=d.parents[i],s=V[l];if(s){if(s.hot._declinedDependencies[o])return{type:"declined",chain:c.concat([l]),moduleId:o,parentId:l};-1===t.indexOf(l)&&(s.hot._acceptedDependencies[o]?(a[l]||(a[l]=[]),u(a[l],[o])):(delete a[l],t.push(l),n.push({chain:c.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:a}}function u(e,t){for(var a=0;a<t.length;a++){var n=t[a];-1===e.indexOf(n)&&e.push(n)}}a=a||{};var c={},i=[],l={},s=function(){console.warn("[HMR] unexpected require("+f.moduleId+") to disposed module")};for(var p in N)if(Object.prototype.hasOwnProperty.call(N,p)){var f;r=q(p);var h=!1,m=!1,g=!1,v="";switch((f=N[p]?o(r):{type:"disposed",moduleId:p}).chain&&(v="\nUpdate propagation: "+f.chain.join(" -> ")),f.type){case"self-declined":a.onDeclined&&a.onDeclined(f),a.ignoreDeclined||(h=new Error("Aborted because of self decline: "+f.moduleId+v));break;case"declined":a.onDeclined&&a.onDeclined(f),a.ignoreDeclined||(h=new Error("Aborted because of declined dependency: "+f.moduleId+" in "+f.parentId+v));break;case"unaccepted":a.onUnaccepted&&a.onUnaccepted(f),a.ignoreUnaccepted||(h=new Error("Aborted because "+r+" is not accepted"+v));break;case"accepted":a.onAccepted&&a.onAccepted(f),m=!0;break;case"disposed":a.onDisposed&&a.onDisposed(f),g=!0;break;default:throw new Error("Unexception type "+f.type)}if(h)return I("abort"),Promise.reject(h);if(m)for(r in l[r]=N[r],u(i,f.outdatedModules),f.outdatedDependencies)Object.prototype.hasOwnProperty.call(f.outdatedDependencies,r)&&(c[r]||(c[r]=[]),u(c[r],f.outdatedDependencies[r]));g&&(u(i,[f.moduleId]),l[r]=s)}var b,w=[];for(t=0;t<i.length;t++)r=i[t],V[r]&&V[r].hot._selfAccepted&&w.push({module:r,errorHandler:V[r].hot._selfAccepted});I("dispose"),Object.keys(C).forEach(function(e){!1===C[e]&&delete F[e]});for(var E,y,x=i.slice();0<x.length;)if(r=x.pop(),d=V[r]){var T={},D=d.hot._disposeHandlers;for(n=0;n<D.length;n++)(e=D[n])(T);for(A[r]=T,d.hot.active=!1,delete V[r],delete c[r],n=0;n<d.children.length;n++){var S=V[d.children[n]];S&&(0<=(b=S.parents.indexOf(r))&&S.parents.splice(b,1))}}for(r in c)if(Object.prototype.hasOwnProperty.call(c,r)&&(d=V[r]))for(y=c[r],n=0;n<y.length;n++)E=y[n],0<=(b=d.children.indexOf(E))&&d.children.splice(b,1);for(r in I("apply"),j=L,l)Object.prototype.hasOwnProperty.call(l,r)&&(k[r]=l[r]);var P=null;for(r in c)if(Object.prototype.hasOwnProperty.call(c,r)&&(d=V[r])){y=c[r];var O=[];for(t=0;t<y.length;t++)if(E=y[t],e=d.hot._acceptedDependencies[E]){if(-1!==O.indexOf(e))continue;O.push(e)}for(t=0;t<O.length;t++){e=O[t];try{e(y)}catch(e){a.onErrored&&a.onErrored({type:"accept-errored",moduleId:r,dependencyId:y[t],error:e}),a.ignoreErrored||P||(P=e)}}}for(t=0;t<w.length;t++){var _=w[t];r=_.module,M=[r];try{R(r)}catch(t){if("function"==typeof _.errorHandler)try{_.errorHandler(t)}catch(e){a.onErrored&&a.onErrored({type:"self-accept-error-handler-errored",moduleId:r,error:e,originalError:t}),a.ignoreErrored||P||(P=e),P||(P=t)}else a.onErrored&&a.onErrored({type:"self-accept-errored",moduleId:r,error:t}),a.ignoreErrored||P||(P=t)}}return P?(I("fail"),Promise.reject(P)):(I("idle"),new Promise(function(e){e(i)}))}var V={},F={7:0},v=[];function R(e){if(V[e])return V[e].exports;var t,n,a=V[e]={i:e,l:!1,exports:{},hot:(t=e,n={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:o!==t,active:!0,accept:function(e,t){if(void 0===e)n._selfAccepted=!0;else if("function"==typeof e)n._selfAccepted=e;else if("object"==typeof e)for(var a=0;a<e.length;a++)n._acceptedDependencies[e[a]]=t||function(){};else n._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)n._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)n._declinedDependencies[e[t]]=!0;else n._declinedDependencies[e]=!0},dispose:function(e){n._disposeHandlers.push(e)},addDisposeHandler:function(e){n._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=n._disposeHandlers.indexOf(e);0<=t&&n._disposeHandlers.splice(t,1)},check:f,apply:g,status:function(e){if(!e)return H;c.push(e)},addStatusHandler:function(e){c.push(e)},removeStatusHandler:function(e){var t=c.indexOf(e);0<=t&&c.splice(t,1)},data:A[t]},o=void 0,n),parents:(r=M,M=[],r),children:[]};return k[e].call(a.exports,a,a.exports,function(t){var a=V[t];if(!a)return R;var n=function(e){return a.hot.active?(V[e]?-1===V[e].parents.indexOf(t)&&V[e].parents.push(t):(M=[t],o=e),-1===a.children.indexOf(e)&&a.children.push(e)):(console.warn("[HMR] unexpected require("+e+") from disposed module "+t),M=[]),R(e)},e=function(t){return{configurable:!0,enumerable:!0,get:function(){return R[t]},set:function(e){R[t]=e}}};for(var r in R)Object.prototype.hasOwnProperty.call(R,r)&&"e"!==r&&"t"!==r&&Object.defineProperty(n,r,e(r));return n.e=function(e){return"ready"===H&&I("prepare"),d++,R.e(e).then(t,function(e){throw t(),e});function t(){d--,"prepare"===H&&(u[e]||h(e),0===d&&0===s&&m())}},n.t=function(e,t){return 1&t&&(e=n(e)),R.t(e,-2&t)},n}(e)),a.l=!0,a.exports}R.m=k,R.c=V,R.d=function(e,t,a){R.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},R.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},R.t=function(t,e){if(1&e&&(t=R(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(R.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)R.d(a,n,function(e){return t[e]}.bind(null,n));return a},R.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return R.d(t,"a",t),t},R.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},R.p="",R.h=function(){return j};var b=window.webpackJsonp=window.webpackJsonp||[],w=b.push.bind(b);b.push=e,b=b.slice();for(var E=0;E<b.length;E++)e(b[E]);var y=w;v.push([1586,0]),l()}({1574:function(e,t,a){},1575:function(e,t,a){},1576:function(e,t,a){},1577:function(e,t,a){},1586:function(e,t,a){"use strict";a.r(t);a(161);var n,r,o,c,i,l,s,d=a(0),g=a.n(d),w=a(2),u=a.n(w),p=a(6),v=a.n(p),f=a(8),E=a.n(f),h=a(17),m=a.n(h),b=a(10),y=a.n(b),x=a(11),T=a.n(x),D=a(12),S=a.n(D),P=a(13),O=a.n(P),_=a(32),k=a.n(_),j=a(14),A=a.n(j),M=a(3),H=a(51),I=a(55),N=a(25),L=a(66),C=a(5),q=(a(1574),N.a.Item),V=M.Select.Option,F=["新增","修改","详情"],R=function(e){function t(e){var a;return y()(this,t),(a=S()(this,O()(t).call(this,e))).onCloseEdit=function(){var e,t=a.props.comModalParam;e=Object.assign({},t,{showModal:!1,btnFlag:0}),w.actions.walsinTree.updateState({comModalParam:e,showLoading:!1})},a.onSubmitEdit=m()(E.a.mark(function e(){var p;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(p=k()(a)).props.form.validateFields(function(){var a=m()(E.a.mark(function e(t,a){var n,r,o,c,i,l,s,d,u;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t)return e.abrupt("return");e.next=4;break;case 4:return e.next=6,w.actions.walsinTree.updateState({showLoading:!0});case 6:if(n=p.props||{},r=n.comModalParam,o=n.paginationParam,i=(c=r||{}).initEditValue,l=c.btnFlag,s=o.reqParam||{},d=s.search_treeId,u={},console.log("onsave oldData",i),l||d){e.next=13;break}return p.onCloseEdit(),w.actions.walsinTree.updateState({showLoading:!1}),Object(C.a)("请选择树节点"),e.abrupt("return");case 13:if(p.handleIntData(a),u=Object.assign({},{treeId:d},i,a),l)return e.next=18,w.actions.walsinTree.addEditData(u);e.next=20;break;case 18:e.next=22;break;case 20:return e.next=22,w.actions.walsinTree.addTableData(u);case 22:p.onCloseEdit();case 23:case"end":return e.stop()}},e)}));return function(e,t){return a.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e)})),a.handleIntData=function(e){for(var t=0,a=["age"];t<a.length;t++){var n=a[t];void 0!==e[n]&&(e[n]=Number(e[n]))}},a.onHideEdit=function(){a.onCloseEdit()},a.onHandleBtns=function(e){return 2==e?[]:a.defaultBtnConfig},a.defaultBtnConfig=[{label:"取消",fun:a.onCloseEdit,shape:"border"},{label:"确定",fun:a.onSubmitEdit,colors:"primary"}],a.state={},a}return A()(t,e),T()(t,[{key:"render",value:function(){var e=this.props,t=e.form,a=e.comModalParam||{},n=a.showModal,r=void 0!==n&&n,o=a.initEditValue,c=void 0===o?{}:o,i=a.btnFlag,l=void 0===i?0:i,s=t.getFieldProps,d=t.getFieldError,u=c||{},p=u.name,f=u.sex,h=u.age,m=this.onHandleBtns(l);return g.a.createElement(L.a,{show:r,title:F[l],size:"lg",btns:m,close:this.onCloseEdit},g.a.createElement(N.a,null,g.a.createElement(q,{required:!0,label:"员工姓名"},g.a.createElement(M.FormControl,v()({disabled:2==l},s("name",{validateTrigger:"onBlur",initialValue:p||"",rules:[{type:"string",required:!0,pattern:/\S+/gi,message:"请输入员工姓名"}]}))),g.a.createElement("span",{className:"error"},d("name"))),g.a.createElement(q,{required:!0,label:"员工性别"},g.a.createElement(M.Select,v()({disabled:2==l},s("sex",{initialValue:f||1,rules:[{required:!0,message:"请选择员工性别"}]})),g.a.createElement(V,{value:1},"女"),g.a.createElement(V,{value:2},"男")),g.a.createElement("span",{className:"error"},d("sex"))),g.a.createElement(q,{required:!0,label:"年龄"},g.a.createElement(M.InputNumber,v()({iconStyle:"one",min:1,step:1,max:99,disabled:2==l},s("age",{initialValue:h||"",rules:[{type:"number",max:99,transform:function(e){return 1*e},pattern:/^[0-9]+$/,required:!0,message:"年龄需小于100"}]}))),g.a.createElement("span",{className:"error"},d("age")))))}}]),t}(d.Component),B=N.a.createForm()(R),K=a(18),z=a(56),G=a(76),U=(a(1575),function(e){function t(e){var l;return y()(this,t),(l=S()(this,O()(t).call(this,e))).getSelectedDataFunc=function(e){console.log("selvalue",e),w.actions.walsinTree.updateState({tableSelValue:e})},l.freshData=function(e){l.onPageSelect(e,0)},l.onDataNumSelect=function(e,t){l.onPageSelect(t,1)},l.onPageSelect=function(e,t){var a=k()(l),n=a.props.paginationParam,r=n.reqParam&&Object(C.f)(n.reqParam)||{};console.log("paginationParam",n);var o=Object(C.k)(e,t,r),c=o.pageIndex,i=o.pageSize;r.pageIndex=c,r.pageSize=i,w.actions.walsinTree.loadTable(r),a.resetSelData()},l.onCommonClick=function(i){return function(e){var t=k()(l).props,a=t.comModalParam,n=t.paginationParam,r=t.tableSelValue,o={},c=r.length;if(a=Object(C.f)(a),0<i){if(!Array.isArray(r)||!c)return void Object(C.c)("请选择表数据");if(1<c)return void Object(C.c)("请选择单条表数据");o=Object.assign({},a,{showModal:!0,initEditValue:r[0],btnFlag:i})}else{void 0!==n.reqParam&&n.reqParam.search_treeId||""?o={showModal:!0,btnFlag:i,initEditValue:{}}:Object(C.c)("请选择表数据所属树节点")}w.actions.walsinTree.updateState({comModalParam:o})}},l.onDelete=m()(E.a.mark(function e(){var t;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.props.tableSelValue,Array.isArray(t)&&0<t.length)return e.next=4,w.actions.walsinTree.updateState({delModal:!0});e.next=6;break;case 4:e.next=7;break;case 6:Object(C.c)("请选择数据");case 7:case"end":return e.stop()}},e)})),l.onModalDel=function(){var t=m()(E.a.mark(function e(t){var a,n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=k()(l),n=a.props.tableSelValue,t)return e.next=5,w.actions.walsinTree.updateState({showLoading:!0});e.next=10;break;case 5:return e.next=7,w.actions.walsinTree.delTableData(n);case 7:a.closeModal(),e.next=11;break;case 10:a.closeModal();case 11:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),l.closeModal=m()(E.a.mark(function e(){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.actions.walsinTree.updateState({showLoading:!1,delModal:!1});case 2:case"end":return e.stop()}},e)})),l.onExport=function(){l.grid.exportExcel()},l.resetSelData=function(){w.actions.walsinTree.updateState({tableSelValue:[]})},l.onHandleDisabled=function(){var e=l.props.tableSelValue.length;return e?1==e?{0:!1,1:!1,2:!1,3:!1}:{0:!1,1:!0,2:!0,3:!1}:{0:!1,1:!0,2:!0,3:!0}},l.getHeight=function(){var e,t=Math.max(document.body.clientHeight,document.documentElement.clientHeight),a=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);e=(t<a&&t||a)-42-58-43-42-32,l.setState({tableHeight:e})},l.state={tableHeight:500},l.grid=null,l.column=[{title:"姓名",dataIndex:"name",key:"name",width:200},{title:"性别",dataIndex:"sexEnumValue",key:"sexEnumValue",width:200},{title:"年龄",dataIndex:"age",key:"age",width:200}],l}return A()(t,e),T()(t,[{key:"componentWillMount",value:function(){var e=this;e.getHeight(),window.onresize=function(){e.getHeight()}}},{key:"componentWillUnmount",value:function(){window.onresize={}}},{key:"componentDidMount",value:function(){var e=this.props.paginationParam;w.actions.walsinTree.loadTable(e.reqParam||{pageIndex:0,pageSize:25}),this.resetSelData()}},{key:"render",value:function(){var t=this,e=this,a=e.props,n=a.tableData,r=void 0===n?[]:n,o=a.paginationParam,c=a.delModal,i=(o.reqParam||{}).pageIndex,l=o.resParam||{},s=l.totalPages,d=void 0===s?0:s,u=l.total,p={activePage:i+1,total:void 0===u?0:u,items:d,freshData:e.freshData,onDataNumSelect:e.onDataNumSelect},f=e.onHandleDisabled(),h=e.state.tableHeight;return g.a.createElement("div",{className:"tree-table"},g.a.createElement("div",{className:"table-header"},g.a.createElement(G.a,{funcCode:"tree"},g.a.createElement(K.a,{colors:"primary",style:{margin:8},onClick:e.onCommonClick(0),role:"add",disabled:f[0]},"新增"),g.a.createElement(K.a,{style:{margin:8},onClick:e.onCommonClick(1),role:"update",shape:"border",disabled:f[1]},"修改"),g.a.createElement(K.a,{style:{margin:8},shape:"border",onClick:e.onCommonClick(2),disabled:f[2]},"详情"),g.a.createElement(K.a,{style:{margin:8},onClick:e.onDelete,role:"delete",shape:"border",disabled:f[3]},"删除")),g.a.createElement(K.a,{style:{margin:8},size:"sm",onClick:e.onExport,shape:"border"},"导出")),g.a.createElement(I.a,{ref:function(e){return t.grid=e},data:r,rowKey:function(e,t){return e.id},columns:e.column,paginationObj:p,getSelectedDataFunc:e.getSelectedDataFunc,multiSelect:{type:"checkbox"},scroll:{y:h}}),g.a.createElement(B,this.props),g.a.createElement(z.a,{show:c,context:"是否要删除 ?",confirmFn:function(){return t.onModalDel(!0)},cancelFn:function(){return t.onModalDel(!1)}}))}}]),t}(d.Component)),W=(a(1576),M.Tree.TreeNode),J=function(e){function t(e){var u;return y()(this,t),(u=S()(this,O()(t).call(this,e))).onExpand=function(e){w.actions.walsinTree.updateState({searchRes:{expandedKeys:e,autoExpandParent:!1}})},u.onChange=function(e){k()(u).setState({searchValue:e})},u.onSearch=m()(E.a.mark(function e(){var t,a;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=k()(u),a=t.state.searchValue,e.next=3,w.actions.walsinTree.getSearchTree({searchValue:a});case 3:case"end":return e.stop()}},e)})),u.onSelect=function(e,t){var a=k()(u),n=t.selectedNodes,r=e.length?e[0]:"",o="",c="";if(n.length){var i=n[0],l=i.props;o=i.props.title.props.children[2],c=l.hierarchy}var s,d=a.props.paginationParam;s=Object.assign({},d.reqParam||{},{search_treeId:r,title:o,hierarchy:c}),w.actions.walsinTree.loadTable(s)},u.onMouseEnter=function(e){var t=Object(C.f)(u.state.editNode);t.isHover=e.node.props.eventKey,u.setState({editNode:t})},u.onMouseLeave=function(e,t){u.setState({editNode:{isHover:"",editKey:""}})},u.onDrop=function(){var t=m()(E.a.mark(function e(t){var a,n,r,o,c;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=k()(u),n=t.dragNode,r=t.node,o=Object(C.m)(a.props.content,{id:n.props.eventKey},0),c=Object.assign({},o,{parentId:r.props.eventKey}),e.next=6,w.actions.walsinTree.dragNode({curNode:o,reqParam:c});case 6:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),u.onLoadData=function(e){console.log("treeNode",e);var a=e.props.eventKey,n=k()(u);return new Promise(function(e,t){n.idLoaded(a)||w.actions.walsinTree.loadTree({id:a}),e()}).then(function(e){console.log("result",e)}).catch(function(e){console.log("失败："+e)})},u.idLoaded=function(e){var t=k()(u),a=t.props.content;return 0<a.length&&t.checkedLoaded(a,e)},u.checkedLoaded=function(e,t){for(var a=e.length,n=!1,r=0;r<a;r++){var o=e[r],c=o.children;if(o.id==t){if(c&&0<c.length){n=!0;break}}else c&&(n=u.checkedLoaded(c,t))}return n},u.getHeight=function(){var e=Math.min(window.innerHeight,document.body.clientHeight,document.documentElement.clientHeight),t=Math.min(window.innerHeight,document.body.scrollHeight,document.documentElement.scrollHeight);document.documentElement.offsetHeight;return(e<t&&e||t)-32-document.documentElement.scrollTop},u.getTableWidth=function(){return Math.min(window.innerWidth,document.documentElement.clientWidth,document.body.clientWidth)-250},u.state={searchValue:"",editNode:{isHover:"",editKey:""}},u}return A()(t,e),T()(t,[{key:"componentDidMount",value:function(){w.actions.walsinTree.loadTree()}},{key:"render",value:function(){var e=this,t=e.props,a=t.showLoading,n=t.content,r=t.searchRes,o=t.paginationParam,c=r.expandedKeys,i=r.autoExpandParent,l=o.reqParam,s=(void 0===l?{}:l).search_treeId,d=e.state.searchValue,u=e.getTableWidth();return g.a.createElement("div",{className:"tree-example"},g.a.createElement(H.a,{title:"B1左树右表示例"}),g.a.createElement("div",{className:"tree-body"},g.a.createElement("div",{className:"tree-wrap"},g.a.createElement("div",{className:"tree"},g.a.createElement("div",{className:"tree-head"},"组织机构"),g.a.createElement("div",{className:"tree-search"},g.a.createElement(M.FormControl,{className:"search-box",placeholder:"Search",onChange:e.onChange,onSearch:e.onSearch,value:d,type:"search"})),n.length?g.a.createElement(M.Tree,{showLine:!0,openIcon:g.a.createElement(M.Icon,{type:"uf-arrow-down"}),closeIcon:g.a.createElement(M.Icon,{type:"uf-arrow-right"}),onExpand:e.onExpand,expandedKeys:c,autoExpandParent:i,defaultExpandAll:!0,onSelect:e.onSelect,onCheck:e.onSelect,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,draggable:!1,onDragEnter:this.onDragEnter,onDrop:this.onDrop,loadData:e.onLoadData,selectedKeys:[s]},function o(e){return e.map(function(e){var t=e.name.search(d),a=e.name.substr(0,t),n=e.name.substr(t+d.length),r=-1<t?g.a.createElement("span",null,a,g.a.createElement("span",{style:{color:"#f50"}},d),n):g.a.createElement("span",null,e.name);return e.children&&e.children.length?g.a.createElement(W,{className:"tree-node",hierarchy:e.parentId,title:r,key:e.id},o(e.children)):g.a.createElement(W,{className:"tree-node",hierarchy:e.parentId,title:r,key:e.id,isLeaf:void 0===e.isSon||1===e.isSon})})}(n)):g.a.createElement("div",{className:"no-search-container"},g.a.createElement("span",{className:"no-search"},"未查询到相关数据"))),g.a.createElement("div",{className:"table-wrap"},g.a.createElement(U,v()({},this.props,{tableWidth:u})))),g.a.createElement(M.Loading,{show:a,fullScreen:!0})))}}]),t}(d.Component),X=a(157),$=a.n(X),Q=a(29),Y=a.n(Q),Z=a(21),ee={GET_DETAIL:"".concat("/iuap-pap-demo-be","/allowances/list"),GET_TREE_DATA:"".concat("/iuap-pap-demo-be","/tree_demo/getSonNodes"),DRAG_NODE:"".concat("/iuap-pap-demo-be","/tree_demo/draftingNode"),GET_TABLE_DATA:"".concat("/iuap-pap-demo-be","/table_demo/list"),ADD_TABLE_DATA:"".concat("/iuap-pap-demo-be","/table_demo/insertSelective"),EDIT_SAVE_DATA:"".concat("/iuap-pap-demo-be","/table_demo/updateSelective"),DEL_TABLE_DATA:"".concat("/iuap-pap-demo-be","/table_demo/deleteBatch"),TREE_SEARCH:"".concat("/iuap-pap-demo-be","/tree_demo/dataSearchNodes")},te=(a(4),{name:"walsinTree",initialState:{content:[],cacheTree:[],paginationParam:{reqParam:{search_treeId:"",title:"",hierarchy:"",pageIndex:0,pageSize:25},resParam:{totalPages:0,total:0}},tableData:[],tableSelValue:[],showLoading:!1,comModalParam:{showModal:!1,initEditValue:{},btnFlag:0},delModal:!1,searchRes:{expandedKeys:[],autoExpandParent:!1}},reducers:{updateState:function(e,t){return Y()({},e,t)}},effects:{loadTree:(s=m()(E.a.mark(function e(a,n){var r,o,c,i,l,s,d;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("loadTree param",a),r=n().walsinTree.cacheTree,e.t0=C.o,e.next=5,t=a,console.log("param",t),Object(Z.a)(ee.GET_TREE_DATA,{method:"get",param:t});case 5:e.t1=e.sent,o=(0,e.t0)(e.t1),c=o.result,i=c.data,l=[],s=i&&i.content||[],r=i&&i.content&&r.concat(i.content),d=Object(C.f)(n().walsinTree.content),l=0===d.length?Object(C.f)(s):Object(C.d)(d,s),w.actions.walsinTree.updateState({content:l,cacheTree:r});case 15:case"end":return e.stop()}var t},e)})),function(e,t){return s.apply(this,arguments)}),dragNode:(l=m()(E.a.mark(function e(a,n){var r,o,c,i;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(C.f)(n().walsinTree.content),o={},a.reqParam)return e.t0=C.o,e.next=6,t=a.reqParam,console.log("param",t),Object(Z.a)(ee.DRAG_NODE,{method:"post",data:t});e.next=10;break;case 6:e.t1=e.sent,c=(0,e.t0)(e.t1),i=c.result,o=i.data;case 10:o&&(Object(C.m)(r,a.curNode,1),console.log("cacheContent",r),Object(C.d)(r,Array.isArray(o)?o:[o]),w.actions.walsinTree.updateState({content:r}));case 11:case"end":return e.stop()}var t},e)})),function(e,t){return l.apply(this,arguments)}),loadTable:(i=m()(E.a.mark(function e(a,t){var n,r,o,c,i;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.actions.walsinTree.updateState({showLoading:!0});case 2:return e.prev=2,e.t0=C.o,e.next=6,t=a,Object(Z.a)(ee.GET_TABLE_DATA,{method:"get",param:t});case 6:return e.t1=e.sent,n=(0,e.t0)(e.t1),r=n.result,o=r.data,c=[],i={},o&&(c=o.content,i=Object.assign({},{reqParam:a,resParam:{total:o.totalElements,totalPages:o.totalPages}})),e.next=14,w.actions.walsinTree.updateState({tableData:c,paginationParam:i,tableSelValue:[],showLoading:!1});case 14:e.next=19;break;case 16:e.prev=16,e.t2=e.catch(2),w.actions.walsinTree.updateState({showLoading:!1});case 19:case"end":return e.stop()}var t},e,null,[[2,16]])})),function(e,t){return i.apply(this,arguments)}),addTableData:(c=m()(E.a.mark(function e(a,n){var r,o,c;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=C.o,e.next=3,t=a,Object(Z.a)(ee.ADD_TABLE_DATA,{method:"post",data:t});case 3:e.t1=e.sent,r=(0,e.t0)(e.t1,"添加成功"),o=r.result,o.data&&(c=n().walsinTree.paginationParam.reqParam,w.actions.walsinTree.loadTable(c));case 8:case"end":return e.stop()}var t},e)})),function(e,t){return c.apply(this,arguments)}),addEditData:(o=m()(E.a.mark(function e(a,n){var r,o,c;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=C.o,e.next=3,t=a,Object(Z.a)(ee.EDIT_SAVE_DATA,{method:"post",data:t});case 3:e.t1=e.sent,r=(0,e.t0)(e.t1,"修改成功"),o=r.result,o.data&&(c=n().walsinTree.paginationParam.reqParam,w.actions.walsinTree.loadTable(c));case 8:case"end":return e.stop()}var t},e)})),function(e,t){return o.apply(this,arguments)}),delTableData:(r=m()(E.a.mark(function e(a,n){var r,o,c;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=C.o,e.next=3,t=a,Object(Z.a)(ee.DEL_TABLE_DATA,{method:"post",data:t});case 3:e.t1=e.sent,r=(0,e.t0)(e.t1,"删除成功"),o=r.result,o.data&&((c=n().walsinTree.paginationParam.reqParam).pageIndex=0,w.actions.walsinTree.loadTable(c));case 8:case"end":return e.stop()}var t},e)})),function(e,t){return r.apply(this,arguments)}),getSearchTree:(n=m()(E.a.mark(function e(a,n){var r,o,c,i,l,s,d,u,p,f,h,m,g,v,b;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.actions.walsinTree.updateState({showLoading:!0});case 2:return r=a.searchValue,o=n().walsinTree.paginationParam,o=Object(C.f)(o),i=(c=o).reqParam,l=c.reqParam,s=l.title,d=l.hierarchy,console.log("searchValue",$()(a.searchValue)),e.prev=7,e.t0=C.o,e.next=11,t=a,Object(Z.a)(ee.TREE_SEARCH,{method:"get",param:t});case 11:if(e.t1=e.sent,u=(0,e.t0)(e.t1),p=u.result,f=p.data,m=(h=void 0!==f&&f||{content:[],parentIdSet:[]}).content,g=h.parentIdSet,console.log("res",f),Array.isArray(m))return v={},b={content:m,searchRes:{expandedKeys:g,autoExpandParent:!!a.searchValue}},(""==r&&"0"!=d||!s.includes(r))&&(v={search_treeId:"",title:"",hierarchy:""}),o.reqParam=Object.assign({},i,v),b.paginationParam=o,e.next=25,w.actions.walsinTree.updateState(b);e.next=27;break;case 25:e.next=28;break;case 27:throw new Error("返回content为null");case 28:e.next=34;break;case 30:e.prev=30,e.t2=e.catch(7),console.log(e.t2),w.actions.walsinTree.updateState({showLoading:!1,content:[]});case 34:return e.next=36,w.actions.walsinTree.updateState({showLoading:!1});case 36:case"end":return e.stop()}var t},e,null,[[7,30]])})),function(e,t){return n.apply(this,arguments)})}});u.a.model(te);var ae=Object(w.connect)(function(e){return e.walsinTree},null)(J);a(1577);Object(w.render)(g.a.createElement(ae,null),document.querySelector("#app"))}});
>>>>>>> 07962f095dd39ac8321bb5cdd1a51d83bf3c6bf4
//# sourceMappingURL=index.js.map